<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>动态博客管理后台</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        .sidebar {
            min-height: 100vh;
            background: #2c3e50;
        }
        
        .sidebar .nav-link {
            color: #ecf0f1;
            padding: 12px 20px;
            border-radius: 0;
            transition: all 0.3s;
        }
        
        .sidebar .nav-link:hover,
        .sidebar .nav-link.active {
            background: #34495e;
            color: #3498db;
        }
        
        .sidebar .nav-link i {
            margin-right: 10px;
        }
        
        .main-content {
            background: #f8f9fa;
            min-height: 100vh;
        }
        
        .card {
            border: none;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            border-radius: 0.5rem;
        }
        
        .card-header {
            background: #fff;
            border-bottom: 1px solid #dee2e6;
            font-weight: 600;
        }
        
        .btn-primary {
            background: #3498db;
            border-color: #3498db;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            border-color: #2980b9;
        }
        
        .avatar-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #dee2e6;
        }
        
        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .stats-card.success {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .stats-card.warning {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .stats-card.info {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- 侧边栏 -->
            <div class="col-md-3 col-lg-2 px-0 sidebar">
                <div class="p-3 text-center">
                    <h5 class="text-white mb-0">📝 博客管理</h5>
                </div>
                <nav class="nav flex-column">
                    <a class="nav-link active" href="#dashboard" data-bs-toggle="tab">
                        <i class="bi bi-speedometer2"></i> 仪表盘
                    </a>
                    <a class="nav-link" href="#profile" data-bs-toggle="tab">
                        <i class="bi bi-person-circle"></i> 个人资料
                    </a>
                    <a class="nav-link" href="#posts" data-bs-toggle="tab">
                        <i class="bi bi-file-text"></i> 文章管理
                    </a>
                    <a class="nav-link" href="#categories" data-bs-toggle="tab">
                        <i class="bi bi-tags"></i> 分类管理
                    </a>
                    <a class="nav-link" href="#appearance" data-bs-toggle="tab">
                        <i class="bi bi-palette"></i> 外观设置
                    </a>
                    <a class="nav-link" href="#social" data-bs-toggle="tab">
                        <i class="bi bi-share"></i> 社交链接
                    </a>
                    <a class="nav-link" href="#settings" data-bs-toggle="tab">
                        <i class="bi bi-gear"></i> 系统设置
                    </a>
                </nav>
            </div>
            
            <!-- 主内容区 -->
            <div class="col-md-9 col-lg-10 main-content">
                <div class="tab-content">
                    <!-- 仪表盘 -->
                    <div class="tab-pane fade show active" id="dashboard">
                        <div class="p-4">
                            <h2 class="mb-4">📊 仪表盘</h2>
                            
                            <!-- 统计卡片 -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="card stats-card">
                                        <div class="card-body text-center">
                                            <h3 class="mb-0" id="totalPosts">0</h3>
                                            <p class="mb-0">总文章数</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card stats-card success">
                                        <div class="card-body text-center">
                                            <h3 class="mb-0" id="totalViews">0</h3>
                                            <p class="mb-0">总浏览量</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card stats-card warning">
                                        <div class="card-body text-center">
                                            <h3 class="mb-0" id="totalLikes">0</h3>
                                            <p class="mb-0">总点赞数</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card stats-card info">
                                        <div class="card-body text-center">
                                            <h3 class="mb-0" id="totalComments">0</h3>
                                            <p class="mb-0">总评论数</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 最近文章 -->
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">📄 最近文章</h5>
                                </div>
                                <div class="card-body">
                                    <div id="recentPosts"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 个人资料 -->
                    <div class="tab-pane fade" id="profile">
                        <div class="p-4">
                            <h2 class="mb-4">👤 个人资料</h2>
                            
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">基本信息</h5>
                                </div>
                                <div class="card-body">
                                    <form id="profileForm">
                                        <div class="row">
                                            <div class="col-md-3 text-center">
                                                <img id="avatarPreview" src="/assets/images/avatar.jpg" class="avatar-preview mb-3">
                                                <input type="file" id="avatarInput" class="form-control" accept="image/*">
                                            </div>
                                            <div class="col-md-9">
                                                <div class="row">
                                                    <div class="col-md-6 mb-3">
                                                        <label class="form-label">姓名</label>
                                                        <input type="text" class="form-control" id="profileName" value="博主">
                                                    </div>
                                                    <div class="col-md-6 mb-3">
                                                        <label class="form-label">昵称</label>
                                                        <input type="text" class="form-control" id="profileNickname" value="小博主">
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label class="form-label">个人简介</label>
                                                    <textarea class="form-control" id="profileBio" rows="3">热爱技术，热爱生活</textarea>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 mb-3">
                                                        <label class="form-label">邮箱</label>
                                                        <input type="email" class="form-control" id="profileEmail" value="example@email.com">
                                                    </div>
                                                    <div class="col-md-6 mb-3">
                                                        <label class="form-label">所在地</label>
                                                        <input type="text" class="form-control" id="profileLocation" value="中国">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-primary">💾 保存个人资料</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 文章管理 -->
                    <div class="tab-pane fade" id="posts">
                        <div class="p-4">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h2 class="mb-0">📄 文章管理</h2>
                                <button class="btn btn-primary" onclick="showNewPostModal()">
                                    <i class="bi bi-plus"></i> 新建文章
                                </button>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">文章列表</h5>
                                </div>
                                <div class="card-body">
                                    <div id="postsList"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 其他标签页占位 -->
                    <div class="tab-pane fade" id="categories">
                        <div class="p-4">
                            <h2 class="mb-4">🏷️ 分类管理</h2>
                            <div class="alert alert-info">分类管理功能开发中...</div>
                        </div>
                    </div>
                    
                    <div class="tab-pane fade" id="appearance">
                        <div class="p-4">
                            <h2 class="mb-4">🎨 外观设置</h2>
                            <div class="alert alert-info">外观设置功能开发中...</div>
                        </div>
                    </div>
                    
                    <div class="tab-pane fade" id="social">
                        <div class="p-4">
                            <h2 class="mb-4">🔗 社交链接</h2>
                            <div class="alert alert-info">社交链接功能开发中...</div>
                        </div>
                    </div>
                    
                    <div class="tab-pane fade" id="settings">
                        <div class="p-4">
                            <h2 class="mb-4">⚙️ 系统设置</h2>
                            <div class="alert alert-info">系统设置功能开发中...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 全局数据
        let profileData = {};
        let postsData = { posts: [], categories: [], tags: [] };
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            setupEventListeners();
            updateDashboard();
        });
        
        // 加载数据
        async function loadData() {
            try {
                // 加载个人资料
                const profileResponse = await fetch('/src/data/profile.json');
                profileData = await profileResponse.json();
                
                // 加载文章数据
                const postsResponse = await fetch('/src/data/posts.json');
                postsData = await postsResponse.json();
                
                // 填充表单
                fillProfileForm();
                
                // 渲染列表
                renderPostsList();
                
            } catch (error) {
                console.error('加载数据失败:', error);
                showAlert('加载数据失败，使用默认数据', 'warning');
            }
        }
        
        // 设置事件监听器
        function setupEventListeners() {
            // 表单提交事件
            document.getElementById('profileForm').addEventListener('submit', saveProfile);
        }
        
        // 填充个人资料表单
        function fillProfileForm() {
            if (profileData.basic) {
                document.getElementById('profileName').value = profileData.basic.name || '';
                document.getElementById('profileNickname').value = profileData.basic.nickname || '';
                document.getElementById('profileBio').value = profileData.basic.bio || '';
                document.getElementById('profileEmail').value = profileData.basic.email || '';
                document.getElementById('profileLocation').value = profileData.basic.location || '';
                
                if (profileData.basic.avatar) {
                    document.getElementById('avatarPreview').src = profileData.basic.avatar;
                }
            }
        }
        
        // 更新仪表盘
        function updateDashboard() {
            const totalPosts = postsData.posts.length;
            const totalViews = postsData.posts.reduce((sum, post) => sum + (post.views || 0), 0);
            const totalLikes = postsData.posts.reduce((sum, post) => sum + (post.likes || 0), 0);
            const totalComments = postsData.posts.reduce((sum, post) => sum + (post.comments?.length || 0), 0);
            
            document.getElementById('totalPosts').textContent = totalPosts;
            document.getElementById('totalViews').textContent = totalViews;
            document.getElementById('totalLikes').textContent = totalLikes;
            document.getElementById('totalComments').textContent = totalComments;
            
            renderRecentPosts();
        }
        
        // 渲染最近文章
        function renderRecentPosts() {
            const recentPosts = postsData.posts
                .sort((a, b) => new Date(b.publishDate) - new Date(a.publishDate))
                .slice(0, 5);
            
            const container = document.getElementById('recentPosts');
            container.innerHTML = recentPosts.map(post => `
                <div class="d-flex justify-content-between align-items-center py-2 border-bottom">
                    <div>
                        <h6 class="mb-1">${post.title}</h6>
                        <small class="text-muted">${new Date(post.publishDate).toLocaleDateString()}</small>
                    </div>
                    <span class="badge bg-${post.status === 'published' ? 'success' : 'secondary'}">${post.status === 'published' ? '已发布' : '草稿'}</span>
                </div>
            `).join('');
        }
        
        // 渲染文章列表
        function renderPostsList() {
            const container = document.getElementById('postsList');
            container.innerHTML = postsData.posts.map(post => `
                <div class="card mb-3">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h6 class="card-title mb-1">${post.title}</h6>
                                <p class="card-text text-muted small mb-1">${post.excerpt}</p>
                                <div class="d-flex gap-2">
                                    <span class="badge bg-primary">${post.categories[0]}</span>
                                    ${post.tags.map(tag => `<span class="badge bg-secondary">${tag}</span>`).join('')}
                                </div>
                            </div>
                            <div class="col-md-2 text-center">
                                <span class="badge bg-${post.status === 'published' ? 'success' : 'warning'}">${post.status === 'published' ? '已发布' : '草稿'}</span>
                                <div class="small text-muted mt-1">${new Date(post.publishDate).toLocaleDateString()}</div>
                            </div>
                            <div class="col-md-2 text-end">
                                <button class="btn btn-sm btn-outline-primary" onclick="editPost('${post.id}')">编辑</button>
                                <button class="btn btn-sm btn-outline-danger" onclick="deletePost('${post.id}')">删除</button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // 保存个人资料
        function saveProfile(e) {
            e.preventDefault();
            
            profileData.basic = {
                name: document.getElementById('profileName').value,
                nickname: document.getElementById('profileNickname').value,
                bio: document.getElementById('profileBio').value,
                email: document.getElementById('profileEmail').value,
                location: document.getElementById('profileLocation').value,
                avatar: document.getElementById('avatarPreview').src
            };
            
            saveData();
            showAlert('个人资料保存成功！', 'success');
        }
        
        // 保存数据
        function saveData() {
            localStorage.setItem('blogProfileData', JSON.stringify(profileData));
            localStorage.setItem('blogPostsData', JSON.stringify(postsData));
        }
        
        // 显示新建文章模态框
        function showNewPostModal() {
            showAlert('新建文章功能开发中...', 'info');
        }
        
        // 编辑文章
        function editPost(id) {
            showAlert('编辑功能开发中...', 'info');
        }
        
        // 删除文章
        function deletePost(id) {
            if (confirm('确定要删除这篇文章吗？')) {
                postsData.posts = postsData.posts.filter(post => post.id !== id);
                saveData();
                renderPostsList();
                updateDashboard();
                showAlert('文章删除成功！', 'success');
            }
        }
        
        // 显示提示
        function showAlert(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 3000);
        }
    </script>
</body>
</html>
